(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{129:function(e,t,n){},200:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),i=n(15),c=n.n(i),r=n(3),s=(n(129),n(56)),l=n.n(s),d=n(107),u=n(57),h=n(58),j=n(67),b=n(66),f=n(16),p=n(17),O=n(120);var v=Object(O.a)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{color:"#ff0000",pos:{x:0,y:0},isConnected:!1,sharedEnv:{isTestVersion:!1,pixelSize:0,canvasSize:{width:0,height:0}}},t=arguments.length>1?arguments[1]:void 0;if("undefined"===typeof e)return 0;switch(t.type){case"COLOR":return Object(r.a)(Object(r.a)({},e),{},{color:t.newColor});case"MOUSE_POS":return Object(r.a)(Object(r.a)({},e),{},{pos:t.pos});case"IS_CONNECTED":return Object(r.a)(Object(r.a)({},e),{},{isConnected:t.isConnected});case"SHARED_ENV":return Object(r.a)(Object(r.a)({},e),{},{sharedEnv:t.sharedEnv});default:return e}})),m=n(108),x=n.n(m),g=n(109),C=n.n(g)()({query:{room:window.location.pathname.replace("/","")}}),y=n(110);var S,w,E,z,k,M,P=n.n(y).a,_=[{name:"red",color:"#ff0000"},{name:"black",color:"#000000"},{name:"gray",color:"#808080"},{name:"purple",color:"#800080"},{name:"green",color:"#008000"},{name:"yellow",color:"#ffff00"},{name:"orange",color:"#ffb733"}],D=n(22),N=n(19),I=n(2),R=p.a.div(S||(S=Object(f.a)(["\n  width: ",";\n  height: ",";\n  /* background: rgba(0, 0, 0, 0.5); */\n  image-rendering: pixelated;\n\n  border: "," solid\n    ",";\n  z-index: 100;\n  position: absolute;\n  pointer-events: none;\n"])),(function(e){return e.size+"px"}),(function(e){return e.size+"px"}),(function(e){return e.size/10+"px"}),(function(e){return Object(N.e)(e.color,.6)})),X=function(e){return Object(I.jsx)(R,Object(r.a)(Object(r.a)({},e),{},{children:e.children}))},T=n(189),Y=p.a.canvas(w||(w=Object(f.a)(['\n  /* border: 10px solid #000000; */\n  margin: 0;\n  padding: 0;\n  position: relative;\n  image-rendering: pixelated;\n  display: block;\n  /* \n  &::before {\n    content: "";\n    position: absolute;\n    border-style: solid;\n    border-width: 0 16px 16px;\n    border-color: red transparent;\n    display: block;\n    width: 0;\n    z-index: 1;\n    margin-left: -16px;\n    top: -16px;\n    left: 50%;\n  } */\n']))),L=p.a.div(E||(E=Object(f.a)(["\n  height: 100vh;\n  width: 100vw;\n  display: block;\n  cursor: crosshair;\n"]))),F=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).createBorder=function(){a.canvasContext.lineWidth=2*v.getState().sharedEnv.pixelSize,a.canvasContext.setLineDash([a.canvasContext.lineWidth,a.canvasContext.lineWidth]),a.canvasContext.strokeStyle="#ff00ff",a.canvasContext.strokeRect(0,0,a.props.sharedEnv.canvasSize.width,a.props.sharedEnv.canvasSize.height)},a.loadMap=function(e){a.resetCanvas(),(e=new T(e)).forEach(function(){var e=Object(d.a)(l.a.mark((function e(t,n){var o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=t.color,a.changePixel(o,n);case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())},a.loadMapFromAPI=function(e){P.get("/api/map",{params:{room:window.location.pathname.replace("/","")}}).then((function(e){var t=e.data;v.dispatch({type:"SHARED_ENV",sharedEnv:Object(r.a)(Object(r.a)({},v.getState().sharedEnv),{},{canvasSize:Object(r.a)({},t.canvasSize)})}),a.loadMap(t.map)})).catch((function(e){alert("An error occured while loading map."),window.location.reload()}))},a.onPaint=function(e){var t=e.x,n=e.y,o=e.color;a.changePixel(o,[t,n])},a.onJoinRoom=function(e){a.loadMapFromAPI(e)},a.resetCanvas=function(){a.canvasContext.clearRect(0,0,a.props.sharedEnv.canvasSize.width||0,a.props.sharedEnv.canvasSize.height||0),a.createBorder()},a.calculatePlaceholderPosition=function(e){var t=v.getState().sharedEnv.pixelSize*a.state.scale;e.mX=e.mX-(e.mX-a.state.lastCoord.x)%t,e.mY=e.mY-(e.mY-a.state.lastCoord.y)%t},a.onMouseMove=function(e){var t=a.getMousePos(a.canvas.current,e),n=a.state.lastCoord.scale;if(t={x:t.x-t.x%v.getState().sharedEnv.pixelSize,y:t.y-t.y%v.getState().sharedEnv.pixelSize,curX:e.clientX-e.clientX%(v.getState().sharedEnv.pixelSize*n),curY:e.clientY-e.clientY%(v.getState().sharedEnv.pixelSize*n),scale:a.state.lastCoord.scale,mX:e.clientX,mY:e.clientY},a.calculatePlaceholderPosition(t),v.dispatch({type:"MOUSE_POS",pos:t}),1!==e.nativeEvent.which&&3!==e.nativeEvent.which){var o=a.canvasContext.getImageData(t.x,t.y,1,1).data;a.setState((function(e){return Object(r.a)(Object(r.a)({},e),{},{color:"rgba(".concat(o[0],",").concat(o[1],",").concat(o[2],",255})"),lastCoord:Object(r.a)(Object(r.a)({},e.lastCoord),{},{mX:t.mX,mY:t.mY})})}))}1!==e.nativeEvent.which&&3!==e.nativeEvent.which||e.altKey||(a.setState((function(e){return Object(r.a)(Object(r.a)({},e),{},{lastCoord:Object(r.a)(Object(r.a)({},e.lastCoord),{},{mX:t.mX,mY:t.mY})})})),a.paint(t,3===e.nativeEvent.which?"#ffffff":v.getState().color))},a.onMouseDown=function(e){var t=a.getMousePos(a.canvas.current,e);t={x:t.x-t.x%v.getState().sharedEnv.pixelSize,y:t.y-t.y%v.getState().sharedEnv.pixelSize},1!==e.nativeEvent.which&&3!==e.nativeEvent.which||e.altKey||(a.setState((function(t){return Object(r.a)(Object(r.a)({},t),{},{lastCoord:Object(r.a)(Object(r.a)({},t.lastCoord),{},{which:e.buttons})})})),a.paint(t,3===e.nativeEvent.which?"#ffffff":v.getState().color))},a.paint=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t||v.getState().color;a.setState((function(t){return Object(r.a)(Object(r.a)({},t),{},{color:n,lastPaint:Object(r.a)(Object(r.a)({},e),{},{color:n})})})),C.emit("paint",Object(r.a)(Object(r.a)({},e),{},{color:n}))},a.getMousePos=function(e,t){var n=e.getBoundingClientRect(),a=n.left+0,o=n.top+0,i=n.right+0,c=n.bottom+0;return Object(r.a)({x:(t.clientX-a)/(i-a)*e.width,y:(t.clientY-o)/(c-o)*e.height},t)},a.canvas=o.a.createRef(null),a.state={scale:1,lastCoord:{x:0,y:0,scale:1,mX:0,mY:0},mapCache:new T,color:"rgba()"},a}return Object(h.a)(n,[{key:"changePixel",value:function(e,t){this.canvasContext.fillStyle=e,this.canvasContext.fillRect(t[0],t[1],v.getState().sharedEnv.pixelSize,v.getState().sharedEnv.pixelSize)}},{key:"componentDidMount",value:function(){var e=this;null!=this.canvas&&(this.canvasContext=this.canvas.current.getContext("2d"),this.canvas.current.focus());var t=x()(this.canvas.current,{minZoom:.5,beforeMouseDown:function(e){if(4!==e.buttons)return!e.altKey}});t.on("transform",(function(n){localStorage.setItem("lastCameraPos",JSON.stringify(Object(r.a)({},t.getTransform()))),e.setState((function(e){return Object(r.a)(Object(r.a)({},e),{},{scale:t.getTransform().scale,lastCoord:Object(r.a)({},t.getTransform())})}),(function(){}))})),C.on("paint",this.onPaint),C.on("loadMap",this.loadMap),C.on("onJoinRoom",this.onJoinRoom),C.on("disconnect",(function(){window.location.reload()})),C.on("roomError",(function(){window.location="/"}))}},{key:"onKeyPressed",value:function(e){Number(e.key)>0&&Number(e.key)<_.length+1&&v.dispatch({type:"COLOR",newColor:_[Number(e.key)-1].color})}},{key:"render",value:function(){return Object(I.jsxs)(L,{onMouseDown:this.onMouseDown,onKeyDown:this.onKeyPressed,onContextMenu:function(e){e.preventDefault()},children:[Object(I.jsx)(X,{size:v.getState().sharedEnv.pixelSize*this.state.scale,borderSize:0,color:"#ffffff"===this.state.color?"#000000":this.state.color,style:{transform:"translate("+this.state.lastCoord.mX+"px,"+this.state.lastCoord.mY+"px)"}}),Object(I.jsx)(Y,{ref:this.canvas,onMouseMove:this.onMouseMove,width:this.props.sharedEnv.canvasSize.width||0,height:this.props.sharedEnv.canvasSize.height||0})]})}}]),n}(a.Component),A=Object(D.b)((function(e){return{sharedEnv:e.sharedEnv}}))(F),H=n(33),J=p.a.div(z||(z=Object(f.a)(["\n  position: absolute;\n  /* width: 100%; */\n  display: flex;\n\n  ","\n  z-index:1000;\n  justify-content: ",";\n"])),(function(e){return"center"===(e.justify||"center")&&"\n    left: 50%;\n    transform: translateX(-50%);\n    "}),(function(e){return e.justify||"center"})),W=function(e){return Object(I.jsx)(J,Object(r.a)(Object(r.a)({onClick:function(e){return e.preventDefault()},onMouseMove:function(e){return e.preventDefault()}},e),{},{children:e.children}))},B=n(68),K=p.a.div(k||(k=Object(f.a)(["\n  background: ",";\n  height: 50px;\n  width: 30px;\n  height: 100%;\n  margin-right: 10px;\n  border-radius: 100%;\n  cursor: pointer;\n\n  &:last-of-type {\n    margin-right: 0px;\n  }\n\n  &:hover {\n    background: ",";\n  }\n\n  transition: border 0.1s;\n\n  &.selected {\n    background: ",";\n    border: 4px solid ",";\n  }\n"])),(function(e){return e.color}),(function(e){return Object(B.b)(.1,e.color)}),(function(e){return Object(B.b)(.1,e.color)}),(function(e){return Object(B.a)(.2,e.color)}));function q(e){return Object(I.jsx)(K,Object(r.a)({},e))}var V,U,Z=p.a.div(M||(M=Object(f.a)(["\n  background: #424242;\n  min-height: 16px;\n  /* width: auto; */\n  border-radius: 10px;\n\n  position: relative;\n  padding: 10px;\n  display: inline-flex;\n  justify-content: center;\n  align-items: center;\n  align-self: flex-start;\n\n  user-select: none;\n\n  overflow: hidden;\n\n  box-shadow: 0 2px 3px rgba(0, 0, 0, 0.5);\n\n  margin-right: 10px;\n\n  &:last-of-type {\n    margin-right: 0px;\n  }\n"]))),G=function(e){return Object(I.jsx)(Z,Object(r.a)(Object(r.a)({},e),{},{children:e.children}))},Q=n(59);function $(){var e=Object(a.useState)(0),t=Object(H.a)(e,2),n=t[0],o=t[1],i=Object(D.c)((function(e){return e.color})),c=Object(Q.useSnackbar)(),s=function(e,t){var n=_[t];v.dispatch({type:"COLOR",newColor:_[t].color}),localStorage.setItem("selectedColor",t),c.showMessage(Object(I.jsxs)("span",{children:["Color changed to"," ",Object(I.jsx)("span",{style:{color:n.color,fontWeight:"bold"},children:n.name})]})),o(t)},l=Object(a.useRef)(!1);return Object(a.useEffect)((function(){isNaN(parseInt(localStorage.getItem("selectedColor")))||s(0,parseInt(localStorage.getItem("selectedColor")))}),[]),Object(a.useEffect)((function(){var e=_.findIndex((function(e){return e.color===i}));e<0||e>_.length-1||(!1!==l.current?s(0,e):l.current=!0)}),[i]),Object(I.jsx)(W,{style:{bottom:10},children:Object(I.jsx)(G,{className:"animate__animated animate__fadeInUp",style:{height:50,borderRadius:25},children:_.map((function(e,t){return Object(a.createElement)(q,Object(r.a)(Object(r.a)({},e),{},{className:n===t&&"selected",key:t,onClick:function(e){s(0,t)}}))}))})})}var ee=p.a.span(V||(V=Object(f.a)(['\n  color: white;\n  /* font-weight: bold; */\n  font-size: 14px;\n  font-family: "Noto Sans", sans-serif;\n']))),te=Object(p.a)(G)(U||(U=Object(f.a)(["\n  margin-right: 0px;\n  margin-bottom: 10px;\n\n  &:last-of-type {\n    margin-bottom: 0px !important;\n  }\n"])));function ne(){var e=Object(D.c)((function(e){return e.pos})),t=Object(D.c)((function(e){return e.sharedEnv})),n=o.a.useState(0),i=Object(H.a)(n,2),c=i[0],r=i[1];return Object(a.useEffect)((function(){C.on("onJoinRoom",(function(e){C.emit("requestClientCount",(function(e){r(e)}))})),C.emit("requestClientCount",(function(e){r(e)})),C.on("clients",(function(e){r(e)}))}),[]),Object(I.jsxs)(W,{justify:"left",style:{top:10,left:10,flexDirection:"column",pointerEvents:"none"},children:[Object(I.jsx)(te,{className:"animate__animated animate__fadeInDown",children:Object(I.jsxs)(ee,{children:["Press ",Object(I.jsx)("u",{children:"Left Alt + Left Mouse"})," or ",Object(I.jsx)("br",{}),Object(I.jsx)("u",{children:"Middle Mouse"})," to move camera."]})}),Object(I.jsx)(te,{className:"animate__animated animate__fadeInDown",children:Object(I.jsxs)(ee,{children:["X: ",e.x," ",Object(I.jsx)("br",{}),"Y: ",e.y," ",Object(I.jsx)("br",{}),"Width: ",t.canvasSize.width," ",Object(I.jsx)("br",{}),"Height: ",t.canvasSize.height," ",Object(I.jsx)("br",{}),"Online: ",c]})})]})}var ae,oe=n(230),ie=p.a.div(ae||(ae=Object(f.a)(['\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  z-index: 1338;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background: white;\n  font-family: "Noto Sans", sans-serif;\n  flex-direction: column;\n']))),ce=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).getIntinialState=function(){return{isConnected:!1,isHiding:!1,hideCompletely:!1}},a.startLoading=function(){v.dispatch({type:"IS_CONNECTED",isConnected:!1}),a.setState(a.getIntinialState()),"undefined"!==typeof a.timer1&&clearTimeout(a.timer1),"undefined"!==typeof a.timer2&&clearTimeout(a.timer2)},a.onLoadingEnd=function(){a.hideCompletely||a.isHiding||("undefined"!==typeof a.timer1&&clearTimeout(a.timer1),"undefined"!==typeof a.timer2&&clearTimeout(a.timer2),a.setState((function(e){return Object(r.a)(Object(r.a)({},e),{},{isHiding:!0})})),a.timer1=setTimeout((function(){return a.setState((function(e){return Object(r.a)(Object(r.a)({},e),{},{isConnected:!0})}),(function(){a.timer2=setTimeout((function(){a.setState((function(e){return Object(r.a)(Object(r.a)({},e),{},{hideCompletely:!0})})),v.dispatch({type:"IS_CONNECTED",isConnected:!0})}),600)}))}),250))},a.state=a.getIntinialState(),a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){C.on("connect",this.onLoadingEnd),C.on("getMap",this.onLoadingEnd),C.on("disconnect",this.startLoading)}},{key:"render",value:function(){return Object(I.jsx)(I.Fragment,{children:!this.state.hideCompletely&&Object(I.jsxs)(ie,Object(r.a)(Object(r.a)({},this.props),{},{className:this.state.isConnected&&"animate__animated animate__fadeOut",children:[Object(I.jsx)(oe.a,{color:"inherit",style:{marginBottom:20}}),this.props.children]}))})}}]),n}(o.a.PureComponent),re=n(235),se=n(231),le=n(232),de=n(202),ue=n(233),he=n(106);function je(){var e=o.a.useState(!1),t=Object(H.a)(e,2),n=t[0],a=t[1],i=function(){a(!1)},c=Object(D.c)((function(e){return e.sharedEnv.isTestVersion}));return o.a.useEffect((function(){c&&!window.location.host.includes("localhost")&&a(!0)}),[c]),Object(I.jsx)("div",{children:Object(I.jsxs)(re.a,{onClose:i,open:n,children:[Object(I.jsx)(se.a,{id:"customized-dialog-title",onClose:i,children:"Warning"}),Object(I.jsx)(le.a,{dividers:!0,children:Object(I.jsx)(de.a,{gutterBottom:!0,children:"Canvas gets reset every 10 minute because this is test version."})}),Object(I.jsx)(ue.a,{children:Object(I.jsx)(he.a,{onClick:i,color:"inherit",children:"Okay"})})]})})}var be,fe,pe=n(55),Oe=n(238),ve=n(237),me=n(236),xe=p.a.form(be||(be=Object(f.a)(["\n  display: flex;\n  flex-direction: column;\n"]))),ge=Object(p.a)(Oe.a)(fe||(fe=Object(f.a)(["\n  margin-bottom: 10px !important;\n\n  &:last-of-type {\n    margin-bottom: 0px !important;\n  }\n"])));function Ce(){var e=o.a.useState(!0),t=Object(H.a)(e,2),n=t[0],a=t[1],i=o.a.useState({width:600,height:600}),c=Object(H.a)(i,2),s=c[0],l=c[1],d=function(){a(!1)};o.a.useEffect((function(){C.on("onJoinRoom",(function(){d()}))}),[]);var u=function(e){var t=e.target.value;t>1e3&&(t=1e3),t>1e3&&(t=1e3),l((function(n){return Object(r.a)(Object(r.a)({},n),{},Object(pe.a)({},e.target.id,t))}))};return Object(I.jsx)("div",{children:Object(I.jsxs)(re.a,{open:n,children:[Object(I.jsx)(se.a,{onClose:d,children:"Create Session"}),Object(I.jsx)(le.a,{dividers:!0,children:Object(I.jsxs)(xe,{children:[Object(I.jsxs)(ge,{children:[Object(I.jsx)(ve.a,{htmlFor:"width",children:"Canvas Width"}),Object(I.jsx)(me.a,{id:"width",value:s.width,required:!0,type:"number",onChange:u})]}),Object(I.jsxs)(ge,{children:[Object(I.jsx)(ve.a,{htmlFor:"height",children:"Canvas Height"}),Object(I.jsx)(me.a,{id:"height",value:s.height,required:!0,type:"number",onChange:u})]})]})}),Object(I.jsx)(ue.a,{children:Object(I.jsx)(he.a,{onClick:function(){P.post("/api/create-room",{canvasSize:s}).then((function(e){var t=e.data;window.location.href="/"+t.createdRoom.id}))},color:"inherit",children:"Create Session"})})]})})}n(198);var ye=function(e){var t=Object(D.c)((function(e){return e.isConnected}));return o.a.useEffect((function(){P.get("/api/get-environment-vars").then((function(e){var t=e.data;v.dispatch({type:"SHARED_ENV",sharedEnv:Object(r.a)(Object(r.a)({},v.getState().sharedEnv),t)})})).catch((function(e){alert("An error occured while loading map.")}))}),[]),Object(I.jsxs)("div",{children:[Object(I.jsx)(ce,{children:"Connecting to server.."}),Object(I.jsx)(A,{}),Object(I.jsx)(Ce,{}),""!==window.location.pathname.replace("/","")&&Object(I.jsx)(je,{}),!0===t&&""!==window.location.pathname.replace("/","")&&Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)($,{}),Object(I.jsx)(ne,{})]})]})},Se=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,240)).then((function(t){var n=t.getCLS,a=t.getFID,o=t.getFCP,i=t.getLCP,c=t.getTTFB;n(e),a(e),o(e),i(e),c(e)}))},we=n(117),Ee=n(14),ze=n(119),ke=n(234),Me=Object(ze.a)({});c.a.render(Object(I.jsx)(ke.a,{theme:Me,children:Object(I.jsx)(D.a,{store:v,children:Object(I.jsx)(Q.SnackbarProvider,{SnackbarProps:{autoHideDuration:2500,anchorOrigin:{vertical:"top",horizontal:"center"},ClickAwayListenerProps:{mouseEvent:!1},ContentProps:{style:{minWidth:0}}},children:Object(I.jsx)(o.a.StrictMode,{children:Object(I.jsx)(we.a,{children:Object(I.jsx)(Ee.c,{children:Object(I.jsx)(Ee.a,{path:"/",children:Object(I.jsx)(ye,{})})})})})})})}),document.getElementById("root")),Se()}},[[200,1,2]]]);
//# sourceMappingURL=main.158e5fa5.chunk.js.map